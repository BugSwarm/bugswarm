travis_fold:start:worker_info
[0K[33;1mWorker information[0m
hostname: 594f3d08-c567-4b74-96df-156b57267c3a@1.worker-org-57dfd4cd5-ff8q7.gce-production-3
version: v6.2.6 https://github.com/travis-ci/worker/tree/ba21bd30589fd152126e13df30e0cc78ccdf2837
instance: travis-job-18457992-6309-469e-bfef-9c9f4e031c11 travis-ci-sardonyx-xenial-1553530528-f909ac5 (via amqp)
startup: 6.2487408s
travis_fold:end:worker_info
[0Ktravis_time:start:0aa45208
[0Ktravis_time:end:0aa45208:start=1580330965041924412,finish=1580330965176756785,duration=134832373,event=no_world_writable_dirs
[0Ktravis_time:start:02b32d05
[0Ktravis_time:end:02b32d05:start=1580330965179451689,finish=1580330965182132179,duration=2680490,event=setup_filter
[0Ktravis_time:start:19f1d90c
[0Ktravis_time:end:19f1d90c:start=1580330965188036069,finish=1580330965194916183,duration=6880114,event=agent
[0Ktravis_time:start:041bac34
[0Ktravis_time:end:041bac34:start=1580330965197362496,finish=1580330965199240579,duration=1878083,event=check_unsupported
[0Ktravis_time:start:0578d7b9
[0Ktravis_fold:start:system_info
[0K[33;1mBuild system information[0m
Build language: node_js
Build group: stable
Build dist: xenial
Build id: 643564898
Job id: 643564899
Runtime kernel version: 4.15.0-1028-gcp
travis-build version: 74fa7e3af
[34m[1mBuild image provisioning date and time[0m
Mon Mar 25 16:43:24 UTC 2019
[34m[1mOperating System Details[0m
Distributor ID: Ubuntu
Description:  Ubuntu 16.04.6 LTS
Release:  16.04
Codename: xenial
[34m[1mSystemd Version[0m
systemd 229
[34m[1mCookbooks Version[0m
42e42e4 https://github.com/travis-ci/travis-cookbooks/tree/42e42e4
[34m[1mgit version[0m
git version 2.21.0
[34m[1mbash version[0m
GNU bash, version 4.3.48(1)-release (x86_64-pc-linux-gnu)
[34m[1mgcc version[0m
gcc (Ubuntu 5.4.0-6ubuntu1~16.04.11) 5.4.0 20160609
[34m[1mdocker version[0m
Client:
 Version:           18.06.0-ce
 API version:       1.38
 Go version:        go1.10.3
 Git commit:        0ffa825
 Built:             Wed Jul 18 19:11:02 2018
 OS/Arch:           linux/amd64
 Experimental:      false

Server:
 Engine:
  Version:          18.06.0-ce
  API version:      1.38 (minimum version 1.12)
  Go version:       go1.10.3
  Git commit:       0ffa825
  Built:            Wed Jul 18 19:09:05 2018
  OS/Arch:          linux/amd64
  Experimental:     false
[34m[1mclang version[0m
clang version 7.0.0 (tags/RELEASE_700/final)
[34m[1mjq version[0m
jq-1.5
[34m[1mbats version[0m
Bats 0.4.0
[34m[1mshellcheck version[0m
0.6.0
[34m[1mshfmt version[0m
v2.6.3
[34m[1mccache version[0m
3.2.4
[34m[1mcmake version[0m
cmake version 3.12.4
[34m[1mheroku version[0m
heroku/7.22.7 linux-x64 node-v11.10.1
[34m[1mimagemagick version[0m
Version: ImageMagick 6.8.9-9 Q16 x86_64 2018-09-28 http://www.imagemagick.org
[34m[1mmd5deep version[0m
4.4
[34m[1mmercurial version[0m
version 4.8
[34m[1mmysql version[0m
mysql  Ver 14.14 Distrib 5.7.25, for Linux (x86_64) using  EditLine wrapper
[34m[1mopenssl version[0m
OpenSSL 1.0.2g  1 Mar 2016
[34m[1mpacker version[0m
1.3.3
[34m[1mpostgresql client version[0m
psql (PostgreSQL) 10.7 (Ubuntu 10.7-1.pgdg16.04+1)
[34m[1mragel version[0m
Ragel State Machine Compiler version 6.8 Feb 2013
[34m[1msudo version[0m
1.8.16
[34m[1mgzip version[0m
gzip 1.6
[34m[1mzip version[0m
Zip 3.0
[34m[1mvim version[0m
VIM - Vi IMproved 7.4 (2013 Aug 10, compiled Nov 24 2016 16:44:48)
[34m[1miptables version[0m
iptables v1.6.0
[34m[1mcurl version[0m
curl 7.47.0 (x86_64-pc-linux-gnu) libcurl/7.47.0 GnuTLS/3.4.10 zlib/1.2.8 libidn/1.32 librtmp/2.3
[34m[1mwget version[0m
GNU Wget 1.17.1 built on linux-gnu.
[34m[1mrsync version[0m
rsync  version 3.1.1  protocol version 31
[34m[1mgimme version[0m
v1.5.3
[34m[1mnvm version[0m
0.34.0
[34m[1mperlbrew version[0m
/home/travis/perl5/perlbrew/bin/perlbrew  - App::perlbrew/0.86
[34m[1mphpenv version[0m
rbenv 1.1.2
[34m[1mrvm version[0m
rvm 1.29.7 (latest) by Michal Papis, Piotr Kuczynski, Wayne E. Seguin [https://rvm.io]
[34m[1mdefault ruby version[0m
ruby 2.5.3p105 (2018-10-18 revision 65156) [x86_64-linux]
[34m[1mCouchDB version[0m
couchdb 1.6.1
[34m[1mElasticSearch version[0m
5.5.0
[34m[1mInstalled Firefox version[0m
firefox 63.0.1
[34m[1mMongoDB version[0m
MongoDB 4.0.7
[34m[1mPhantomJS version[0m
2.1.1
[34m[1mPre-installed PostgreSQL versions[0m
9.4.21
9.5.16
9.6.12
[34m[1mRedis version[0m
redis-server 5.0.4
[34m[1mPre-installed Go versions[0m
1.11.1
[34m[1mmvn version[0m
Apache Maven 3.6.0 (97c98ec64a1fdfee7767ce5ffb20918da4f719f3; 2018-10-24T18:41:47Z)
[34m[1mgradle version[0m
Gradle 4.10.2!
[34m[1mlein version[0m
Leiningen 2.9.1 on Java 11.0.2 OpenJDK 64-Bit Server VM
[34m[1mPre-installed Node.js versions[0m
v10.15.3
v11.0.0
v4.9.1
v6.17.0
v8.12.0
v8.15.1
v8.9
[34m[1mphpenv versions[0m
  system
  5.6
  5.6.40
  7.1
  7.1.27
  7.2
* 7.2.15 (set by /home/travis/.phpenv/version)
  hhvm
  hhvm-stable
[34m[1mcomposer --version[0m
Composer version 1.8.4 2019-02-11 10:52:10
[34m[1mPre-installed Ruby versions[0m
ruby-2.3.8
ruby-2.4.5
ruby-2.5.3
travis_fold:end:system_info
[0K
travis_time:end:0578d7b9:start=1580330965201697655,finish=1580330965207143853,duration=5446198,event=show_system_info
[0Ktravis_time:start:18fb0b69
[0Ktravis_time:end:18fb0b69:start=1580330965217492189,finish=1580330965255315208,duration=37823019,event=rm_riak_source
[0Ktravis_time:start:089acd94
[0Ktravis_time:end:089acd94:start=1580330965265681159,finish=1580330965275933539,duration=10252380,event=fix_rwky_redis
[0Ktravis_time:start:0ef19b26
[0Ktravis_time:end:0ef19b26:start=1580330965281035157,finish=1580330965582480317,duration=301445160,event=wait_for_network
[0Ktravis_time:start:103bf85c
[0Ktravis_time:end:103bf85c:start=1580330965586514644,finish=1580330965777345042,duration=190830398,event=update_apt_keys
[0Ktravis_time:start:3221cf73
[0Ktravis_time:end:3221cf73:start=1580330965781130624,finish=1580330965828895325,duration=47764701,event=fix_hhvm_source
[0Ktravis_time:start:31c04b86
[0Ktravis_time:end:31c04b86:start=1580330965833044403,finish=1580330965835830795,duration=2786392,event=update_mongo_arch
[0Ktravis_time:start:062645a8
[0Ktravis_time:end:062645a8:start=1580330965841633916,finish=1580330965879058393,duration=37424477,event=fix_sudo_enabled_trusty
[0Ktravis_time:start:05b65a92
[0Ktravis_time:end:05b65a92:start=1580330965882914141,finish=1580330965884791366,duration=1877225,event=update_glibc
[0Ktravis_time:start:08e9b744
[0Ktravis_time:end:08e9b744:start=1580330965888326149,finish=1580330965895350256,duration=7024107,event=clean_up_path
[0Ktravis_time:start:13f378b6
[0Ktravis_time:end:13f378b6:start=1580330965898876038,finish=1580330965906031807,duration=7155769,event=fix_resolv_conf
[0Ktravis_time:start:1812f528
[0Ktravis_time:end:1812f528:start=1580330965909943113,finish=1580330965919324707,duration=9381594,event=fix_etc_hosts
[0Ktravis_time:start:0125550c
[0Ktravis_time:end:0125550c:start=1580330965923328259,finish=1580330965931740580,duration=8412321,event=fix_mvn_settings_xml
[0Ktravis_time:start:03753af2
[0Ktravis_time:end:03753af2:start=1580330965938095968,finish=1580330965947152880,duration=9056912,event=no_ipv6_localhost
[0Ktravis_time:start:0d7e4910
[0Ktravis_time:end:0d7e4910:start=1580330965953894916,finish=1580330965956945593,duration=3050677,event=fix_etc_mavenrc
[0Ktravis_time:start:2ee36380
[0Ktravis_time:end:2ee36380:start=1580330965963269195,finish=1580330965966326369,duration=3057174,event=fix_wwdr_certificate
[0Ktravis_time:start:0fc31824
[0Ktravis_time:end:0fc31824:start=1580330965971442007,finish=1580330965993276955,duration=21834948,event=put_localhost_first
[0Ktravis_time:start:0708d34a
[0Ktravis_time:end:0708d34a:start=1580330965998366336,finish=1580330966001846577,duration=3480241,event=home_paths
[0Ktravis_time:start:18c13aa0
[0Ktravis_time:end:18c13aa0:start=1580330966005599523,finish=1580330966016599199,duration=10999676,event=disable_initramfs
[0Ktravis_time:start:00b41050
[0Ktravis_time:end:00b41050:start=1580330966020380215,finish=1580330966237560042,duration=217179827,event=disable_ssh_roaming
[0Ktravis_time:start:0bd0a0c8
[0Ktravis_time:end:0bd0a0c8:start=1580330966241126653,finish=1580330966243205264,duration=2078611,event=debug_tools
[0Ktravis_time:start:002a41ba
[0Ktravis_time:end:002a41ba:start=1580330966246812762,finish=1580330966249524196,duration=2711434,event=uninstall_oclint
[0Ktravis_time:start:19479216
[0Ktravis_time:end:19479216:start=1580330966253755527,finish=1580330966256370956,duration=2615429,event=rvm_use
[0Ktravis_time:start:0ed12f0f
[0Ktravis_time:end:0ed12f0f:start=1580330966260649077,finish=1580330966268066842,duration=7417765,event=rm_etc_boto_cfg
[0Ktravis_time:start:16bb22d4
[0Ktravis_time:end:16bb22d4:start=1580330966271524169,finish=1580330966273776996,duration=2252827,event=rm_oraclejdk8_symlink
[0Ktravis_time:start:15df993a
[0Ktravis_time:end:15df993a:start=1580330966279350930,finish=1580330966373627493,duration=94276563,event=enable_i386
[0Ktravis_time:start:0d78a0b6
[0Ktravis_time:end:0d78a0b6:start=1580330966377911531,finish=1580330966386770514,duration=8858983,event=update_rubygems
[0Ktravis_time:start:2accc309
[0Ktravis_time:end:2accc309:start=1580330966391134708,finish=1580330967139374814,duration=748240106,event=ensure_path_components
[0Ktravis_time:start:15f6a18a
[0Ktravis_time:end:15f6a18a:start=1580330967143249417,finish=1580330967145818692,duration=2569275,event=redefine_curl
[0Ktravis_time:start:08b1ec9e
[0Ktravis_time:end:08b1ec9e:start=1580330967149176134,finish=1580330967233727193,duration=84551059,event=nonblock_pipe
[0Ktravis_time:start:160a9bbb
[0Ktravis_time:end:160a9bbb:start=1580330967238350203,finish=1580330973271133108,duration=6032782905,event=apt_get_update
[0Ktravis_time:start:05d69160
[0Ktravis_time:end:05d69160:start=1580330973275460698,finish=1580330973277807523,duration=2346825,event=deprecate_xcode_64
[0Ktravis_time:start:06972d34
[0Ktravis_time:end:06972d34:start=1580330973282483509,finish=1580330975638723911,duration=2356240402,event=update_heroku
[0Ktravis_time:start:0e206d54
[0Ktravis_time:end:0e206d54:start=1580330975645136552,finish=1580330975647939607,duration=2803055,event=shell_session_update
[0Ktravis_time:start:08d0c630
[0Ktravis_fold:start:docker_mtu
[0Ktravis_fold:end:docker_mtu
[0Ktravis_time:end:08d0c630:start=1580330975652608001,finish=1580330977862851285,duration=2210243284,event=set_docker_mtu
[0Ktravis_time:start:126a6aa6
[0Ktravis_fold:start:resolvconf
[0Ktravis_fold:end:resolvconf
[0Ktravis_time:end:126a6aa6:start=1580330977868349240,finish=1580330977924483923,duration=56134683,event=resolvconf
[0Ktravis_time:start:01227931
[0Ktravis_time:end:01227931:start=1580330977936823425,finish=1580330978057742125,duration=120918700,event=maven_central_mirror
[0Ktravis_time:start:0329936f
[0Ktravis_time:end:0329936f:start=1580330978061750739,finish=1580330978150508784,duration=88758045,event=maven_https
[0Ktravis_time:start:03b54862
[0Ktravis_fold:start:services
[0Ktravis_time:start:02823292
[0K$ sudo systemctl start mysql
travis_time:end:02823292:start=1580330978157386104,finish=1580330979215869447,duration=1058483343,event=prepare
[0Ktravis_fold:end:services
[0Ktravis_time:end:02823292:start=1580330978157386104,finish=1580330982248764288,duration=4091378184,event=services
[0Ktravis_time:start:25011200
[0Ktravis_time:end:25011200:start=1580330982252367502,finish=1580330982254454497,duration=2086995,event=fix_ps4
[0Ktravis_time:start:12f42e75
[0K
travis_fold:start:git.checkout
[0Ktravis_time:start:0781d25c
[0K$ git clone --depth=50 --branch=master https://github.com/TryGhost/Ghost.git TryGhost/Ghost
Cloning into 'TryGhost/Ghost'...
travis_time:end:0781d25c:start=1580330982261652196,finish=1580330983353343150,duration=1091690954,event=checkout
[0K$ cd TryGhost/Ghost
$ git checkout -qf ef551768bb1632065993351e012fdfd593c2d8de
travis_fold:end:git.checkout
[0K
travis_fold:start:git.submodule
[0Ktravis_time:start:16fd3d60
[0K$ git submodule update --init --recursive
Submodule 'content/themes/casper' (https://github.com/TryGhost/Casper.git) registered for path 'content/themes/casper'
Submodule 'core/client' (https://github.com/TryGhost/Ghost-Admin.git) registered for path 'core/client'
Cloning into '/home/travis/build/TryGhost/Ghost/content/themes/casper'...
Cloning into '/home/travis/build/TryGhost/Ghost/core/client'...
Submodule path 'content/themes/casper': checked out '7c87383bc6217502063db015c61719c90c617eea'
Submodule path 'core/client': checked out '561d1f16e438855795cf6230026f3d51f6dc7ee9'
travis_time:end:16fd3d60:start=1580330983450074333,finish=1580330987710315414,duration=4260241081,event=checkout
[0Ktravis_fold:end:git.submodule
[0Ktravis_time:end:16fd3d60:start=1580330983450074333,finish=1580330987716119666,duration=4266045333,event=checkout
[0Ktravis_time:start:007d1e28
[0K
[33;1mSetting environment variables from repository settings[0m
$ export PUSH_TOKEN=[secure]
$ export SLACK_URL=[secure]

[33;1mSetting environment variables from .travis.yml[0m
$ export DB=sqlite3
$ export NODE_ENV=testing

travis_time:end:007d1e28:start=1580330987720037489,finish=1580330987729183577,duration=9146088,event=env
[0Ktravis_fold:start:nvm.install
[0Ktravis_time:start:0630fb32
[0K$ nvm install 12
Downloading and installing node v12.14.1...
Downloading https://nodejs.org/dist/v12.14.1/node-v12.14.1-linux-x64.tar.xz...
Computing checksum with sha256sum
Checksums matched!
Now using node v12.14.1 (npm v6.13.4)
travis_time:end:0630fb32:start=1580330988461126354,finish=1580330991406013682,duration=2944887328,event=setup
[0Ktravis_fold:end:nvm.install
[0K
travis_fold:start:cache.1
[0KSetting up build cache
$ export CASHER_DIR=${TRAVIS_HOME}/.casher
travis_time:start:014e49a3
[0K$ Installing caching utilities
travis_time:end:014e49a3:start=1580330992436316713,finish=1580330992615828679,duration=179511966,event=setup_casher
[0Ktravis_time:start:05333cf9
[0Ktravis_time:end:05333cf9:start=1580330992623021127,finish=1580330992625585491,duration=2564364,event=setup_casher
[0Ktravis_time:start:0326e9f2
[0Kattempting to download cache archive[0m
[32;1mfetching master/cache--linux-xenial-5a3c100ba51fc69c8c697d48d568d5385090fa49b62c5f41af6060673e12489d--node-12.tgz[0m
[32;1mfound cache[0m
travis_time:end:0326e9f2:start=1580330992629125423,finish=1580330996494600109,duration=3865474686,event=setup_casher
[0Ktravis_fold:end:cache.1
[0K
travis_fold:start:cache.yarn
[0K
travis_time:start:11b1293e
[0Ktravis_time:end:11b1293e:start=1580330996502248887,finish=1580330996504730482,duration=2481595,event=setup_cache
[0Ktravis_time:start:10f5c3bc
[0Kadding /home/travis/.cache/yarn to cache[0m
travis_time:end:10f5c3bc:start=1580330996508148529,finish=1580331009598021683,duration=13089873154,event=setup_cache
[0Ktravis_fold:end:cache.yarn
[0Ktravis_fold:start:cache.npm
[0K
travis_time:start:1b06a39c
[0Ktravis_time:end:1b06a39c:start=1580331009745193697,finish=1580331009748923066,duration=3729369,event=setup_cache
[0Ktravis_time:start:30238ef0
[0Kadding /home/travis/build/TryGhost/Ghost/node_modules to cache[0m
creating directory /home/travis/build/TryGhost/Ghost/node_modules[0m
travis_time:end:30238ef0:start=1580331009755255104,finish=1580331019195362669,duration=9440107565,event=setup_cache
[0Ktravis_fold:end:cache.npm
[0K$ node --version
v12.14.1
$ npm --version
6.13.4
$ nvm --version
0.35.2
$ yarn --version
1.15.2

travis_fold:start:install
[0Ktravis_time:start:0be1cf4c
[0K$ yarn
yarn install v1.15.2
[1/5] Validating package.json...
warning ghost@3.4.0: The engine "cli" appears to be invalid.
[2/5] Resolving packages...
[3/5] Fetching packages...
[4/5] Linking dependencies...
warning " > bookshelf@0.14.2" has incorrect peer dependency "knex@>=0.6.10 <0.15.0".
[5/5] Building fresh packages...
Done in 4.00s.
travis_time:end:0be1cf4c:start=1580331019963483970,finish=1580331024104737157,duration=4141253187,event=install
[0Ktravis_fold:end:install
[0Ktravis_fold:start:before_script.1
[0Ktravis_time:start:09a8c974
[0K$ if [ $DB == "mysql" ]; then mysql -e 'create database ghost_testing'; fi
travis_time:end:09a8c974:start=1580331024109853475,finish=1580331024113866919,duration=4013444,event=before_script
[0Ktravis_fold:end:before_script.1
[0Ktravis_fold:start:before_script.2
[0Ktravis_time:start:2b4d26bb
[0K$ if [ "$DB" == "sqlite3" ]; then yarn add --force sqlite3; fi
yarn add v1.15.2
[1/5] Validating package.json...
warning ghost@3.4.0: The engine "cli" appears to be invalid.
[2/5] Resolving packages...
[3/5] Fetching packages...
[4/5] Linking dependencies...
warning " > bookshelf@0.14.2" has incorrect peer dependency "knex@>=0.6.10 <0.15.0".
[5/5] Rebuilding all packages...
success Saved lockfile.
warning "sqlite3" is already in "optionalDependencies". Please remove existing entry first before adding it to "dependencies".
success Saved 1 new dependency.
info Direct dependencies
â””â”€ sqlite3@4.1.1
info All dependencies
â””â”€ sqlite3@4.1.1
Done in 6.63s.
travis_time:end:2b4d26bb:start=1580331024120292754,finish=1580331030890699032,duration=6770406278,event=before_script
[0Ktravis_fold:end:before_script.2
[0Ktravis_time:start:003b23c8
[0K$ if [[ "$TRAVIS_PULL_REQUEST_BRANCH" =~ ^renovate || "$TRAVIS_EVENT_TYPE" == "cron" ]]; then
  yarn ci:regression
else
  yarn ci
fi

yarn run v1.15.2
$ grunt test-regression --verbose
Initializing
Command-line options: --verbose, --gruntfile=/home/travis/build/TryGhost/Ghost/Gruntfile.js

Reading "Gruntfile.js" Gruntfile...OK

Registering Gruntfile tasks.

Registering "grunt-bg-shell" local Npm module tasks.
Reading /home/travis/build/TryGhost/Ghost/node_modules/grunt-bg-shell/package.json...OK
Parsing /home/travis/build/TryGhost/Ghost/node_modules/grunt-bg-shell/package.json...OK
Loading "bg-shell.coffee" tasks...OK
+ bgShell
Loading "child-process.coffee" tasks...OK
>> No tasks were registered or unregistered.

Registering "grunt-contrib-clean" local Npm module tasks.
Reading /home/travis/build/TryGhost/Ghost/node_modules/grunt-contrib-clean/package.json...OK
Parsing /home/travis/build/TryGhost/Ghost/node_modules/grunt-contrib-clean/package.json...OK
Loading "clean.js" tasks...OK
+ clean

Registering "grunt-contrib-compress" local Npm module tasks.
Reading /home/travis/build/TryGhost/Ghost/node_modules/grunt-contrib-compress/package.json...OK
Parsing /home/travis/build/TryGhost/Ghost/node_modules/grunt-contrib-compress/package.json...OK
Loading "compress.js" tasks...OK
+ compress

Registering "grunt-contrib-copy" local Npm module tasks.
Reading /home/travis/build/TryGhost/Ghost/node_modules/grunt-contrib-copy/package.json...OK
Parsing /home/travis/build/TryGhost/Ghost/node_modules/grunt-contrib-copy/package.json...OK
Loading "copy.js" tasks...OK
+ copy

Registering "grunt-contrib-symlink" local Npm module tasks.
Reading /home/travis/build/TryGhost/Ghost/node_modules/grunt-contrib-symlink/package.json...OK
Parsing /home/travis/build/TryGhost/Ghost/node_modules/grunt-contrib-symlink/package.json...OK
Loading "symlink.js" tasks...OK
+ symlink

Registering "grunt-contrib-uglify" local Npm module tasks.
Reading /home/travis/build/TryGhost/Ghost/node_modules/grunt-contrib-uglify/package.json...OK
Parsing /home/travis/build/TryGhost/Ghost/node_modules/grunt-contrib-uglify/package.json...OK
Loading "uglify.js" tasks...OK
+ uglify

Registering "grunt-contrib-watch" local Npm module tasks.
Reading /home/travis/build/TryGhost/Ghost/node_modules/grunt-contrib-watch/package.json...OK
Parsing /home/travis/build/TryGhost/Ghost/node_modules/grunt-contrib-watch/package.json...OK
Loading "watch.js" tasks...OK
+ watch

Registering "grunt-cssnano" local Npm module tasks.
Reading /home/travis/build/TryGhost/Ghost/node_modules/grunt-cssnano/package.json...OK
Parsing /home/travis/build/TryGhost/Ghost/node_modules/grunt-cssnano/package.json...OK
Loading "cssnano.js" tasks...OK
+ cssnano

Registering "grunt-express-server" local Npm module tasks.
Reading /home/travis/build/TryGhost/Ghost/node_modules/grunt-express-server/package.json...OK
Parsing /home/travis/build/TryGhost/Ghost/node_modules/grunt-express-server/package.json...OK
Loading "express.js" tasks...OK
+ express

Registering "grunt-mocha-cli" local Npm module tasks.
Reading /home/travis/build/TryGhost/Ghost/node_modules/grunt-mocha-cli/package.json...OK
Parsing /home/travis/build/TryGhost/Ghost/node_modules/grunt-mocha-cli/package.json...OK
Loading "mochacli.js" tasks...OK
+ mochacli

Registering "grunt-shell" local Npm module tasks.
Reading /home/travis/build/TryGhost/Ghost/node_modules/grunt-shell/package.json...OK
Parsing /home/travis/build/TryGhost/Ghost/node_modules/grunt-shell/package.json...OK
Loading "shell.js" tasks...OK
+ shell

Registering "grunt-subgrunt" local Npm module tasks.
Reading /home/travis/build/TryGhost/Ghost/node_modules/grunt-subgrunt/package.json...OK
Parsing /home/travis/build/TryGhost/Ghost/node_modules/grunt-subgrunt/package.json...OK
Loading "subgrunt.js" tasks...OK
+ subgrunt

Registering "grunt-update-submodules" local Npm module tasks.
Reading /home/travis/build/TryGhost/Ghost/node_modules/grunt-update-submodules/package.json...OK
Parsing /home/travis/build/TryGhost/Ghost/node_modules/grunt-update-submodules/package.json...OK
Loading "update-submodules.js" tasks...OK
+ update_submodules
Reading package.json...OK
Parsing package.json...OK
Initializing config...OK
Loading "Gruntfile.js" tasks...OK
+ build, default, dev, help, init, knex-migrator, lint, master, master-warn, prod, release, setTestEnv, stubClientFiles, test, test-acceptance, test-all, test-regression, test-setup, test-unit, validate

Running tasks: test-regression

Running "test-regression" task

Running "test-setup" task

Running "knex-migrator" task

Running "clean:test" (clean) task
Verifying property clean.test exists in config...OK
Files: [no src]
Options: force=false, no-write=false
>> 0 paths cleaned.

Running "setTestEnv" task

Running "stubClientFiles" task

Running "mochacli:regression" (mochacli) task
Verifying property mochacli.regression exists in config...OK
Files: core/test/regression/api/admin_spec.js, core/test/regression/api/canary/admin/authentication_spec.js, core/test/regression/api/canary/admin/db_spec.js, core/test/regression/api/canary/admin/images_spec.js, core/test/regression/api/canary/admin/members_spec.js, core/test/regression/api/canary/admin/notifications_spec.js, core/test/regression/api/canary/admin/pages_spec.js, core/test/regression/api/canary/admin/posts_spec.js, core/test/regression/api/canary/admin/redirects_spec.js, core/test/regression/api/canary/admin/schedules_spec.js, core/test/regression/api/canary/admin/settings_spec.js, core/test/regression/api/canary/admin/slack_spec.js, core/test/regression/api/canary/admin/users_spec.js, core/test/regression/api/canary/content/authors_spec.js, core/test/regression/api/canary/content/pages_spec.js, core/test/regression/api/canary/content/posts_spec.js, core/test/regression/api/canary/content/tags_spec.js, core/test/regression/api/v2/admin/authentication_spec.js, core/test/regression/api/v2/admin/db_spec.js, core/test/regression/api/v2/admin/images_spec.js, core/test/regression/api/v2/admin/notifications_spec.js, core/test/regression/api/v2/admin/pages_spec.js, core/test/regression/api/v2/admin/posts_spec.js, core/test/regression/api/v2/admin/redirects_spec.js, core/test/regression/api/v2/admin/schedules_spec.js, core/test/regression/api/v2/admin/settings_spec.js, core/test/regression/api/v2/admin/slack_spec.js, core/test/regression/api/v2/admin/users_spec.js, core/test/regression/api/v2/content/authors_spec.js, core/test/regression/api/v2/content/pages_spec.js, core/test/regression/api/v2/content/posts_spec.js, core/test/regression/api/v2/content/tags_spec.js, core/test/regression/api/v3/admin/authentication_spec.js, core/test/regression/api/v3/admin/db_spec.js, core/test/regression/api/v3/admin/images_spec.js, core/test/regression/api/v3/admin/notifications_spec.js, core/test/regression/api/v3/admin/posts_spec.js, core/test/regression/api/v3/admin/redirects_spec.js, core/test/regression/api/v3/admin/schedules_spec.js, core/test/regression/api/v3/admin/settings_spec.js, core/test/regression/api/v3/admin/slack_spec.js, core/test/regression/api/v3/admin/users_spec.js, core/test/regression/api/v3/content/authors_spec.js, core/test/regression/api/v3/content/pages_spec.js, core/test/regression/api/v3/content/posts_spec.js, core/test/regression/api/v3/content/tags_spec.js, core/test/regression/exporter/exporter_spec.js, core/test/regression/importer/importer_spec.js, core/test/regression/migrations/migration_spec.js, core/test/regression/models/base/listeners_spec.js, core/test/regression/models/model_posts_spec.js, core/test/regression/models/model_users_spec.js, core/test/regression/site/dynamic_routing_spec.js, core/test/regression/site/frontend_spec.js, core/test/regression/site/members_spec.js, core/test/regression/site/site_spec.js, core/test/regression/site/UrlService_spec.js, core/test/regression/update-check/update_check_spec.js
Options: ui="bdd", reporter="spec", timeout="60000", save=undefined, require=["core/server/overrides"], retries="3", exit


  Admin Routing
    Assets
      âœ“ should return 404 for unknown assets
      âœ“ should retrieve built assets
    Admin Redirects
      âœ“ should redirect /GHOST/ to /ghost/
    Require HTTPS - redirect
      âœ“ should redirect admin access over non-HTTPS
      âœ“ should allow admin access over HTTPS

  Authentication API v3
    Blog setup
      âœ“ is setup? no
      âœ“ complete setup (140ms)
      âœ“ is setup? yes
      âœ“ complete setup again
      âœ“ update setup (389ms)
    Invitation
      âœ“ check invite with invalid email
      âœ“ check valid invite
      âœ“ check invalid invite
      âœ“ try to accept without invite
      âœ“ try to accept with invite (111ms)
    Password reset
      âœ“ reset password (133ms)
      âœ“ reset password: invalid token
      âœ“ reset password: generate reset token

  DB API
    - can export the database with more tables
(node:6021) MaxListenersExceededWarning: Possible EventEmitter memory leak detected. 11 committed listeners added to [Function]. Use emitter.setMaxListeners() to increase limit
    âœ“ can export & import (455ms)
    âœ“ import should fail without file
    âœ“ import should fail with unsupported file
    âœ“ export can be triggered by backup integration
    âœ“ export can not be triggered by integration other than backup
    âœ“ export can be triggered by Admin authentication

  Images API
    âœ“ Can't import fail without file
    âœ“ Can't import with unsupported file
    âœ“ Can't upload incorrect extension
    âœ“ Can't import if profile image is not square (97ms)

  Members API
    âœ“ Can browse
    âœ“ Can read
    âœ“ Can add (61ms)
    âœ“ Should fail when passing incorrect email_type query parameter
    âœ“ Can edit by id (39ms)
    - Can set a "Complimentary" subscription
    âœ“ Can destroy (58ms)
    âœ“ Can export CSV
    âœ“ Can import CSV

  Notifications API
    As Editor
      âœ“ Add notification
      âœ“ Read notifications
    As Author
      âœ“ Add notification
      âœ“ Read notifications
    Can view by multiple users
      âœ“ notification is visible and dismissible by other user (73ms)

  Pages API
    Edit
      âœ“ accepts html source (415ms)

  Posts API
    Browse
      âœ“ fields & formats combined (70ms)
      âœ“ combined fields, formats, include and non existing (78ms)
    Read
      âœ“ can't retrieve non existent post
    Add
      âœ“ adds default title when it is missing (47ms)
    Edit
      âœ“ published_at = null (97ms)
      âœ“ html to plaintext (111ms)
      âœ“ canonical_url (71ms)
      âœ“ update dates & x_by (44ms)
      âœ“ Can change scheduled post (46ms)
      âœ“ trims title (79ms)
      âœ“ strips invisible unicode from slug (76ms)
      âœ“ accepts visibility parameter (66ms)
    Destroy
      âœ“ non existent post

  Redirects API
    Download
      âœ“ file does not exist
      âœ“ file exists
    Upload
      Error cases
        âœ“ syntax error
        âœ“ wrong format: no array
        âœ“ wrong format: no from/to
      Ensure re-registering redirects works
        âœ“ no redirects file exists (2380ms)
        âœ“ override (3408ms)

  Canary Schedules API
    publish
      - publishes posts
      - publishes page
      - no access
      - should fail with invalid resource type
      - published_at is x seconds in past, but still in tolerance
      - not found
      - force publish

  Settings API (canary)
    As Owner
      âœ“ Can't read core setting
      âœ“ Can't read permalinks
      âœ“ can't read non existent setting
      âœ“ can toggle member setting
      âœ“ can't edit permalinks
      âœ“ can't edit non existent setting
      âœ“ Will transform "1"
    As Admin
      âœ“ cannot toggle member setting
    As Editor
      âœ“ should not be able to edit settings
    As Author
      âœ“ should not be able to edit settings

  Slack API
    âœ“ Can post slack test

  User API
    As Owner
      Read
        âœ“ can't retrieve non existent user by id
        âœ“ can't retrieve non existent user by slug
      Edit
        âœ“ can change the other users password (103ms)
      Destroy
        âœ“ [failure] Destroy unknown user id
    As Editor
      success cases
        âœ“ can edit himself
      error cases
        âœ“ can't edit the owner
        âœ“ Cannot transfer ownership to any other user
    As Author
      success cases
        âœ“ can edit himself
      error cases
        âœ“ can't edit the owner

  Authors Content API
    âœ“ can read authors with fields

  api/canary/content/pages
    âœ“ Can browse pages with page:false
    âœ“ can't read post

  api/canary/content/posts
    âœ“ browse posts (46ms)
    âœ“ browse posts with related authors/tags also returns primary_author/primary_tag (40ms)
    âœ“ browse posts with basic page filter should not return pages
    âœ“ browse posts with basic page filter should not return pages
    âœ“ browse posts with published and draft status, should not return drafts
    âœ“ ensure origin header on redirect is not getting lost
    âœ“ can't read page
    âœ“ can read post with fields
    content gating
      âœ“ public post fields are always visible (93ms)
      âœ“ cannot read members only post content
      âœ“ cannot read paid only post content
      âœ“ cannot read members only post plaintext
      âœ“ cannot browse members only posts content (39ms)

  api/canary/content/tags
    âœ“ can read tags with fields

  Authentication API v2
    Blog setup: default config
      âœ“ is setup? no
      âœ“ complete setup (134ms)
      âœ“ is setup? yes
      âœ“ complete setup again
      âœ“ update setup (350ms)
    Blog setup: custom config
      âœ“ is setup? no
      âœ“ complete setup (123ms)
      âœ“ is setup? yes
      âœ“ complete setup again
      âœ“ update setup (343ms)
    Invitation
      âœ“ check invite with invalid email
      âœ“ check valid invite
      âœ“ check invalid invite
      âœ“ try to accept without invite
      âœ“ try to accept with invite (114ms)
    Password reset
      âœ“ reset password (122ms)
      âœ“ reset password: invalid token
      âœ“ reset password: generate reset token

  DB API
    - can export the database with more tables
(node:6021) MaxListenersExceededWarning: Possible EventEmitter memory leak detected. 11 committed listeners added to [Function]. Use emitter.setMaxListeners() to increase limit
    âœ“ can export & import (367ms)
    âœ“ import should fail without file
    âœ“ import should fail with unsupported file
    âœ“ export can be triggered by backup integration
    âœ“ export can not be triggered by integration other than backup
    âœ“ export can be triggered by Admin authentication

  Images API
    âœ“ Can't import fail without file
    âœ“ Can't import with unsupported file
    âœ“ Can't upload incorrect extension
    âœ“ Can't import if profile image is not square

  Notifications API
    As Editor
      âœ“ Add notification
      âœ“ Read notifications
    As Author
      âœ“ Add notification
      âœ“ Read notifications
    Can view by multiple users
      âœ“ notification is visible and dismissible by other user (61ms)

  Pages API
    Edit
      âœ“ accepts html source (94ms)

  Posts API
    Browse
      âœ“ fields & formats combined
      âœ“ combined fields, formats, include and non existing
    Read
      âœ“ can't retrieve non existent post
    Add
      âœ“ adds default title when it is missing (45ms)
    Edit
      âœ“ published_at = null (113ms)
      âœ“ html to plaintext (100ms)
      âœ“ canonical_url (65ms)
      âœ“ update dates & x_by (50ms)
      âœ“ Can change scheduled post (52ms)
      âœ“ trims title (76ms)
      âœ“ strips invisible unicode from slug (78ms)
      âœ“ accepts visibility parameter (77ms)
    Destroy
      âœ“ non existent post

  Redirects API
    Download
      âœ“ file does not exist
      âœ“ file exists
    Upload
      Error cases
        âœ“ syntax error
        âœ“ wrong format: no array
        âœ“ wrong format: no from/to
      Ensure re-registering redirects works
        âœ“ no redirects file exists (2158ms)
        âœ“ override (2419ms)

  v2 Schedules API
    publish
      - publishes posts
      - publishes page
      - no access
      - should fail with invalid resource type
      - published_at is x seconds in past, but still in tolerance
      - not found
      - force publish

  Settings API (v2)
    As Owner
      âœ“ Can't read core setting
      âœ“ Can't read permalinks
      âœ“ can't read non existent setting
      âœ“ can toggle member setting
      âœ“ can't edit permalinks
      âœ“ can't edit non existent setting
      âœ“ Will transform "1"
    As Admin
Unhandled rejection Error: SQLITE_IOERR: disk I/O error


      âœ“ cannot toggle member setting
    As Editor
      âœ“ should not be able to edit settings
    As Author
      âœ“ should not be able to edit settings

  Slack API
    âœ“ Can post slack test

  User API
    As Owner
      Read
        âœ“ can't retrieve non existent user by id
        âœ“ can't retrieve non existent user by slug
      Edit
        âœ“ can change the other users password (98ms)
      Destroy
        âœ“ [failure] Destroy unknown user id
    As Editor
      success cases
        âœ“ can edit himself
      error cases
        âœ“ can't edit the owner (41ms)
        âœ“ Cannot transfer ownership to any other user
    As Author
      success cases
        âœ“ can edit himself
      error cases
        âœ“ can't edit the owner (41ms)

  Authors Content API
    âœ“ can read authors with fields

  api/v2/content/pages
    âœ“ Can request pages
    âœ“ Can browse pages with page:false
    âœ“ can't read post

  api/v2/content/posts
    âœ“ Can request posts
    âœ“ browse posts with basic page filter should not return pages
    âœ“ browse posts with basic page filter should not return pages
    âœ“ browse posts with published and draft status, should not return drafts
    âœ“ ensure origin header on redirect is not getting lost
    âœ“ can't read page
    âœ“ can read post with fields
    âœ“ can't read page with multiple keys
    content gating
      âœ“ public post fields are always visible (151ms)
      âœ“ cannot read members only post content
      âœ“ cannot read paid only post content
      âœ“ cannot read members only post plaintext
      âœ“ cannot browse members only posts content

  api/v2/content/tags
    âœ“ can read tags with fields

  Authentication API v3
    Blog setup
      âœ“ is setup? no
      âœ“ complete setup (144ms)
      âœ“ is setup? yes
      âœ“ complete setup again
      âœ“ update setup (368ms)
    Invitation
      âœ“ check invite with invalid email
      âœ“ check valid invite
      âœ“ check invalid invite
      âœ“ try to accept without invite
      âœ“ try to accept with invite (123ms)
    Password reset
(node:6021) MaxListenersExceededWarning: Possible EventEmitter memory leak detected. 101 post.published listeners added to [EventRegistry]. Use emitter.setMaxListeners() to increase limit
      âœ“ reset password (141ms)
      âœ“ reset password: invalid token
      âœ“ reset password: generate reset token

  DB API
    - can export the database with more tables
(node:6021) MaxListenersExceededWarning: Possible EventEmitter memory leak detected. 11 committed listeners added to [Function]. Use emitter.setMaxListeners() to increase limit
    âœ“ can export & import (373ms)
    âœ“ import should fail without file
    âœ“ import should fail with unsupported file
    âœ“ export can be triggered by backup integration
    âœ“ export can not be triggered by integration other than backup
    âœ“ export can be triggered by Admin authentication

  Images API
    âœ“ Can't import fail without file
    âœ“ Can't import with unsupported file
    âœ“ Can't upload incorrect extension
    âœ“ Can't import if profile image is not square

  Notifications API
    As Editor
      âœ“ Add notification
      âœ“ Read notifications
    As Author
      âœ“ Add notification
      âœ“ Read notifications
    Can view by multiple users
      âœ“ notification is visible and dismissible by other user (55ms)

  Posts API
    Browse
      âœ“ fields & formats combined (51ms)
      âœ“ combined fields, formats, include and non existing (59ms)
    Read
      âœ“ can't retrieve non existent post
    Add
      âœ“ adds default title when it is missing (39ms)
    Edit
      âœ“ published_at = null (152ms)
      âœ“ html to plaintext (127ms)
      âœ“ canonical_url (66ms)
      âœ“ update dates & x_by (55ms)
      âœ“ Can change scheduled post
      âœ“ trims title (76ms)
      âœ“ strips invisible unicode from slug (96ms)
    Destroy
      âœ“ non existent post

  Redirects API
    Download
      âœ“ file does not exist
      âœ“ file exists
    Upload
      Error cases
        âœ“ syntax error
        âœ“ wrong format: no array
        âœ“ wrong format: no from/to
      Ensure re-registering redirects works
        âœ“ no redirects file exists (2186ms)
Unhandled rejection Error: SQLITE_IOERR: disk I/O error


Unhandled rejection Error: SQLITE_IOERR: disk I/O error


        âœ“ override (3194ms)

  v3 Schedules API
    publish
      - publishes posts
      - publishes page
      - no access
      - should fail with invalid resource type
      - published_at is x seconds in past, but still in tolerance
      - not found
      - force publish

  Settings API
    âœ“ Can't read core setting
    âœ“ Can't read permalinks
    âœ“ can't read non existent setting
    âœ“ can't edit permalinks
    âœ“ can't edit non existent setting
    âœ“ Will transform "1"

  Slack API
Unhandled rejection Error: SQLITE_IOERR: disk I/O error


    1) "before all" hook

  User API
    As Owner
      Read
        âœ“ can't retrieve non existent user by id
        âœ“ can't retrieve non existent user by slug
      Edit
        âœ“ can change the other users password (98ms)
      Destroy
        âœ“ [failure] Destroy unknown user id
    As Editor
      success cases
        âœ“ can edit himself
      error cases
        âœ“ can't edit the owner (61ms)
        âœ“ Cannot transfer ownership to any other user
    As Author
      success cases
        âœ“ can edit himself
      error cases
        âœ“ can't edit the owner (55ms)

  Authors Content API
    âœ“ can read authors with fields

  api/v3/content/pages
    âœ“ Can browse pages with page:false
    âœ“ can't read post

  api/v3/content/posts
    âœ“ browse posts
    âœ“ browse posts with related authors/tags also returns primary_author/primary_tag (45ms)
    âœ“ browse posts with basic page filter should not return pages
    âœ“ browse posts with basic page filter should not return pages
    âœ“ browse posts with published and draft status, should not return drafts
    âœ“ ensure origin header on redirect is not getting lost
    âœ“ can't read page
    âœ“ can read post with fields
    content gating
      âœ“ public post fields are always visible (220ms)
      âœ“ cannot read members only post content
      âœ“ cannot read paid only post content
      âœ“ cannot read members only post plaintext
      âœ“ cannot browse members only posts content

  api/v3/content/tags
    âœ“ can read tags with fields

  Exporter
    âœ“ exports data

  Integration: Importer
    Empty database (except of owner user), general tests
      âœ“ ensure return structure
      âœ“ cares about invalid dates and date formats (98ms)
      âœ“ warning that theme was not imported
      âœ“ removes duplicate users (185ms)
      âœ“ removes duplicate posts (48ms)
      âœ“ does not treat posts without slug as duplicate (40ms)
      âœ“ can import user with missing allowed fields (106ms)
      âœ“ removes duplicate tags and updates associations (56ms)
      âœ“ removes broken tags from post (not in db, not in file) (152ms)
      âœ“ imports post status (334ms)
      âœ“ ensure complex JSON get's fully imported
      âœ“ import owner, ensure original owner stays as is (184ms)
      âœ“ imports comment_id correctly (38ms)
      âœ“ handles validation errors nicely (229ms)
      âœ“ does import data with invalid user references (240ms)
      âœ“ invalid uuid (622ms)
      âœ“ ensure post tag order is correct (1062ms)
      âœ“ import multiple users, tags, posts (943ms)
      âœ“ can handle if user has multiple roles attached (102ms)
      âœ“ can handle related tags with missing optional fields (564ms)
      âœ“ can handle uppercase tags (274ms)
      âœ“ does not import settings: slack hook, permalinks
      âœ“ does import settings with string booleans
      âœ“ import comment_id (270ms)
      âœ“ ensure authors are imported correctly (1220ms)
      âœ“ import 2.0 Koenig post format (291ms)
    Existing database
      âœ“ import multiple users, tags, posts (1084ms)

  1.0
    âœ“ ensure amp field get's respected (287ms)
    migrate mobiledoc/html
      âœ“ invalid mobiledoc structure (301ms)
      âœ“ mobiledoc is null, html field is set (145ms)
      âœ“ mobiledoc and html is null (148ms)
      âœ“ mobiledoc is set and html is null (150ms)
      âœ“ post has "kg-card-markdown" class (147ms)
      âœ“ import old Koenig Beta post format (273ms)

  LTS
    âœ“ disallows importing LTS imports

  Database Migration (special functions)
    Fixtures
      Populate
        âœ“ should populate all fixtures correctly (47ms)

  Models: listeners
    on timezone changed
      db has scheduled posts
        âœ“ active_timezone changes from London to Los Angeles (272ms)
        âœ“ active_timezone changes from Baghdad to UTC (277ms)
        âœ“ active_timezone changes from Amsterdam to Seoul (257ms)
      db has no scheduled posts
        âœ“ no scheduled posts
    on notifications changed
      âœ“ nothing to delete
      âœ“ expect deletion (117ms)

  Post Model
    Single author posts
      fetchOne/fetchAll/fetchPage
        findPage
          with more posts/tags
            - can findPage, with various options
            - can findPage for tag, with various options
      edit
        âœ“ [failure] multiple edits in one transaction (76ms)
        âœ“ multiple edits in one transaction (90ms)
        âœ“ can change title (81ms)
        âœ“ [failure] custom excerpt soft limit reached (70ms)
        âœ“ can publish draft post (77ms)
        âœ“ can unpublish published post (85ms)
        âœ“ draft -> scheduled without published_at update (74ms)
        âœ“ draft -> scheduled: expect update of published_at (80ms)
        âœ“ scheduled -> draft: expect unschedule (75ms)
        âœ“ scheduled -> scheduled with updated published_at (84ms)
        âœ“ scheduled -> scheduled with unchanged published_at (82ms)
        âœ“ scheduled -> scheduled with unchanged published_at (within the 2 minutes window) (3088ms)
        âœ“ published -> scheduled and expect update of published_at (72ms)
        âœ“ can convert draft post to page and back (103ms)
        âœ“ can convert draft to schedule AND post to page and back (95ms)
        âœ“ can convert published post to page and back (92ms)
        âœ“ can change type and status at the same time (103ms)
        âœ“ cannot override the published_by setting (97ms)
      add
        âœ“ can add, defaults are all correct (105ms)
        âœ“ can add, default visibility is taken from settings cache
        âœ“ can add, with previous published_at date
        âœ“ add draft post without published_at -> we expect no auto insert of published_at
        âœ“ add multiple authors
        âœ“ add draft post with published_at -> we expect published_at to exist
        âœ“ add scheduled post without published_at -> we expect an error
        âœ“ add scheduled post with published_at not in future-> we expect an error
        âœ“ add scheduled post with published_at 1 minutes in future -> we expect an error
        âœ“ add scheduled post with published_at 10 minutes in future -> we expect success
        âœ“ can generate a non conflicting slug (314ms)
        âœ“ can generate slugs without duplicate hyphens
        âœ“ can generate a safe slug when a protected keyword is used
        âœ“ can generate slugs without non-ascii characters
        âœ“ detects duplicate slugs before saving (53ms)
        âœ“ transforms absolute urls to relative
      destroy
        âœ“ published post (187ms)
        âœ“ draft post (194ms)
        âœ“ published page (185ms)
        âœ“ draft page (190ms)
      Collision Protection
        âœ“ update post title, but updated_at is out of sync (74ms)
        âœ“ update post tags and updated_at is out of sync
        âœ“ update post authors and updated_at is out of sync
        âœ“ update post tags and updated_at is NOT out of sync (53ms)
        âœ“ update post with no changes, but updated_at is out of sync (198ms)
        âœ“ update post with old post title, but updated_at is out of sync
    mobiledoc versioning
      âœ“ can create revisions (96ms)
      âœ“ keeps only 10 last revisions in FIFO style (411ms)
      âœ“ creates 2 revisions after first edit for previously unversioned post (84ms)
    Multiauthor Posts
      âœ“ can destroy multiple posts by author (919ms)
    Post tag handling edge cases
      âœ“ should create the test data correctly
      âœ“ can edit slug of existing tag (157ms)
      âœ“ can't edit dates and authors of existing tag (1035ms)
      âœ“ can reorder existing, added and deleted tags (174ms)
      âœ“ can add multiple tags with conflicting slugs (186ms)
      âœ“ can handle lowercase/uppercase tags (170ms)

  User Model
    Registration
      âœ“ can add first (133ms)
      âœ“ shortens slug if possible (135ms)
      âœ“ does not short slug if not possible (389ms)
      âœ“ does NOT lowercase email (130ms)
      âœ“ can find gravatar (129ms)
      âœ“ can handle no gravatar (131ms)
      âœ“ can find by email and is case insensitive (133ms)
    Basic Operations
      âœ“ sets last login time on successful login (91ms)
      âœ“ converts fetched dateTime fields to Date objects (93ms)
      âœ“ can findPage with limit all (393ms)
      âœ“ can findOne by role name (399ms)
      âœ“ can invite user (98ms)
      âœ“ can add active user (99ms)
      âœ“ can NOT add active user with invalid email address (83ms)
      âœ“ can edit active user
      âœ“ can NOT set an invalid email address
      âœ“ can NOT set an already existing email address
      âœ“ can edit invited user (102ms)
      âœ“ can activate invited user (104ms)
      âœ“ can destroy invited user (110ms)
    Password change
      error
        âœ“ wrong old password (80ms)
        âœ“ too short password (81ms)
        âœ“ very bad password (80ms)
        âœ“ password matches users email adress (82ms)
        âœ“ password contains words "ghost" or "password" (81ms)
        âœ“ password matches blog URL (79ms)
        âœ“ password contains repeating chars (79ms)
        âœ“ password contains repeating numbers (80ms)
    User setup
      âœ“ setup user (92ms)

  Dynamic Routing
    Collection Index
      âœ“ should respond with html (189ms)
      âœ“ should not have a third page
      RSS
        âœ“ should 301 redirect with CC=1year without slash
        âœ“ should respond with 200 & CC=public (73ms)
        âœ“ should get 301 redirect with CC=1year to /rss/ from /feed/
    Collection Entry
      âœ“ should render page with slug permalink (169ms)
      âœ“ should not render page with dated permalink
    Tag
      âœ“ should return HTML for valid route (67ms)
      âœ“ should 404 for /tag/ route
      âœ“ should 404 for unknown tag
      âœ“ should 404 for unknown tag with invalid characters
      RSS
        âœ“ should redirect without slash
        âœ“ should respond with xml (49ms)
      Edit
        âœ“ should redirect without slash
        âœ“ should redirect to tag settings
        âœ“ should 404 for non-edit parameter
      Edit with admin redirects disabled
(node:6021) MaxListenersExceededWarning: Possible EventEmitter memory leak detected. 101 post.published.edited listeners added to [EventRegistry]. Use emitter.setMaxListeners() to increase limit
(node:6021) MaxListenersExceededWarning: Possible EventEmitter memory leak detected. 101 post.unpublished listeners added to [EventRegistry]. Use emitter.setMaxListeners() to increase limit
(node:6021) MaxListenersExceededWarning: Possible EventEmitter memory leak detected. 101 page.published listeners added to [EventRegistry]. Use emitter.setMaxListeners() to increase limit
(node:6021) MaxListenersExceededWarning: Possible EventEmitter memory leak detected. 101 page.published.edited listeners added to [EventRegistry]. Use emitter.setMaxListeners() to increase limit
(node:6021) MaxListenersExceededWarning: Possible EventEmitter memory leak detected. 101 page.unpublished listeners added to [EventRegistry]. Use emitter.setMaxListeners() to increase limit
(node:6021) MaxListenersExceededWarning: Possible EventEmitter memory leak detected. 101 tag.added listeners added to [EventRegistry]. Use emitter.setMaxListeners() to increase limit
(node:6021) MaxListenersExceededWarning: Possible EventEmitter memory leak detected. 101 tag.edited listeners added to [EventRegistry]. Use emitter.setMaxListeners() to increase limit
(node:6021) MaxListenersExceededWarning: Possible EventEmitter memory leak detected. 101 tag.deleted listeners added to [EventRegistry]. Use emitter.setMaxListeners() to increase limit
        âœ“ should redirect without slash
        âœ“ should not redirect to admin
      Paged
        - should redirect without slash
        - should respond with html
        - should redirect page 1
        - should 404 if page too high
        - should 404 if page too low
        RSS
          - should 404 if index attempted with 0
          - should 404 if index attempted with 1
          - should 404 for other pages
    Author
      âœ“ should 404 for /author/ route (162ms)
      âœ“ should 404 for unknown author
      âœ“ should 404 for unknown author with invalid characters
      âœ“ [success] author is locked
      âœ“ [success] author is suspended
      âœ“ [failure] ghost owner before blog setup
      âœ“ [success] ghost owner after blog setup (91ms)
      RSS
        âœ“ should redirect without slash
        âœ“ should respond with xml
      Edit
        âœ“ should redirect without slash
        âœ“ should redirect to editor
        âœ“ should 404 for something that isn't edit
      Edit with admin redirects disabled
        âœ“ should redirect without slash
        âœ“ should not redirect to admin
      Paged
        âœ“ should redirect without slash
        âœ“ should respond with html (105ms)
        âœ“ should redirect page 1
        âœ“ should 404 if page too high
        âœ“ should 404 if page too low
        RSS
          âœ“ should 404 if index attempted with 0
          âœ“ should 404 if index attempted with 1
          âœ“ should 404 for other pages
    Reload routes.yaml
      âœ“ confirm current routing pattern (154ms)
      âœ“ simulate upload of routes.yaml (1008ms)
      âœ“ serve welcome post with old permalink structure
      âœ“ serve welcome post with new permalink structure
      âœ“ serve welcome post with new permalink structure and old date
      âœ“ serve serve rss
      âœ“ serve collection index
      âœ“ serve tag (41ms)

  Frontend Routing
    Test with Initial Fixtures
      Error
        âœ“ should 404 for unknown post
        âœ“ should 404 for unknown post with invalid characters
        âœ“ should 404 for unknown frontend route
        âœ“ should 404 for encoded char not 301 from uncapitalise
        âœ“ should 404 for unknown file
      Single post
        âœ“ should redirect without slash
        âœ“ should redirect uppercase
        âœ“ should sanitize double slashes when redirecting uppercase
        âœ“ should respond with html for valid post url (75ms)
        âœ“ should not work with date permalinks
      Post edit
        âœ“ should redirect without slash
        âœ“ should redirect to editor
        âœ“ should 404 for non-edit parameter
      Post edit with admin redirects disabled
        âœ“ should redirect without slash
        âœ“ should not redirect to editor
      AMP post
        âœ“ should redirect without slash
        âœ“ should redirect uppercase
        âœ“ should respond with html for valid url (170ms)
        âœ“ should not work with date permalinks
        âœ“ should redirect to regular post when AMP is disabled
        âœ“ should redirect to regular post with query params when AMP is disabled
      Static assets
        âœ“ should retrieve theme assets
        âœ“ should retrieve default robots.txt
        âœ“ should retrieve default favicon.ico
    Test with added posts
      Static page
        âœ“ should respond with html (116ms)
        âœ“ should redirect without slash
        edit
          âœ“ should redirect without slash
          âœ“ should redirect to editor
          âœ“ should 404 for non-edit parameter
        edit with admin redirects disabled
          âœ“ should redirect without slash
          âœ“ should not redirect to editor (122ms)
        amp
          âœ“ should 404 for amp parameter (114ms)
      Post preview
        âœ“ should display draft posts accessed via uuid (49ms)
        âœ“ should redirect published posts to their live url
        âœ“ 404s unknown uuids
      Post with Ghost in the url
        âœ“ should retrieve a blog post with ghost at the start of the url (56ms)
    Site Map
      âœ“ should serve sitemap.xml
      âœ“ should serve sitemap-posts.xml
      âœ“ should serve sitemap-pages.xml
      âœ“ should serve sitemap-tags.xml
      âœ“ should serve sitemap-users.xml
    Subdirectory (no slash)
      âœ“ http://localhost should 404
      âœ“ http://localhost/ should 404
      âœ“ http://localhost/blog should 301 to  http://localhost/blog/
      âœ“ http://localhost/blog/ should 200 (44ms)
      âœ“ http://localhost/blog/welcome should 301 to http://localhost/blog/welcome/
      âœ“ http://localhost/blog/welcome/ should 200 (54ms)
      âœ“ /blog/tag/getting-started should 301 to /blog/tag/getting-started/
      âœ“ /blog/tag/getting-started/ should 200 (42ms)
      âœ“ /blog/welcome/amp/ should 200
    Subdirectory (with slash)
      âœ“ http://localhost should 404
      âœ“ http://localhost/ should 404
      âœ“ /blog should 301 to /blog/
      âœ“ /blog/ should 200 (42ms)
      âœ“ /blog/welcome should 301 to /blog/welcome/
      âœ“ /blog/welcome/ should 200 (64ms)
      âœ“ /blog/tag/getting-started should 301 to /blog/tag/getting-started/
      âœ“ /blog/tag/getting-started/ should 200 (45ms)
      âœ“ /blog/welcome/amp/ should 200
      âœ“ should uncapitalise correctly with 301 to subdir
    HTTPS
      âœ“ should set links to url over non-HTTPS
      âœ“ should set links over HTTPS besides canonical (53ms)
    Redirects (use redirects.json from test/utils/fixtures/data)
      1 case
        âœ“ with trailing slash
        âœ“ without trailing slash
        âœ“ with query params
        âœ“ with query params
        âœ“ with case insensitive
        âœ“ with case sensitive
        âœ“ defaults to case sensitive
        âœ“ should not redirect with case sensitive
        âœ“ should not redirect with default case sensitive
      2 case
        âœ“ with trailing slash
        âœ“ without trailing slash
      3 case
        âœ“ with trailing slash
        âœ“ without trailing slash
      4 case
        âœ“ with trailing slash
        âœ“ without trailing slash
      5 case
        âœ“ with trailing slash
        âœ“ without trailing slash
      6 case
        âœ“ with trailing slash
        âœ“ without trailing slash
      7 case
        âœ“ with trailing slash
      last case
        âœ“ default
        âœ“ with a custom path
      external url redirect
        âœ“ with trailing slash
        âœ“ without trailing slash

  Integration - Web - Members
    Members enabled
      Static files
        âœ“ should serve members.js file
      Routes
        âœ“ should error when invalid member token is passed in to ssr
        âœ“ should return no content when removing member sessions
        âœ“ should error serving webhook endpoint without any parameters
    Members disabled
      Static files
        âœ“ should not serve members js file
      Routes
        âœ“ should not serve ssr endpoint
        âœ“ should not serve ssr removal endpoint
        âœ“ should not serve webhook endpoint

  Integration - Web - Site
    v2
      default routes.yaml
        behaviour: default cases
(node:6021) [DEP0066] DeprecationWarning: OutgoingMessage.prototype._headers is deprecated
          âœ“ serve post (75ms)
          âœ“ serve amp
          âœ“ post not found (41ms)
          âœ“ serve static page
          âœ“ serve author (45ms)
          âœ“ serve tag (43ms)
          âœ“ serve tag rss
          âœ“ serve collection (40ms)
          âœ“ serve collection: page 2
          âœ“ serve theme asset
        behaviour: prettify
          âœ“ url without slash
        behaviour: url redirects
          pagination
            âœ“ redirect /page/1/ to /
          rss
            âœ“ redirect /feed/ to /rss/
      https
        protocol
          âœ“ blog is https, request is http
          âœ“ blog is https, request is http, trailing slash exists already
        assets
          âœ“ blog is https, request is http
          âœ“ blog is https, request is http
      extended routes.yaml: collections
        2 collections
          âœ“ serve static route
          âœ“ serve rss
          âœ“ serve post
          âœ“ serve collection: podcast with default template
          âœ“ serve collection: something with custom template
        no collections
          âœ“ serve route
        static permalink route
          âœ“ serve post
          âœ“ serve post (66ms)
          âœ“ serve author
          âœ“ serve tag
        primary author permalink
          âœ“ serve post (68ms)
          âœ“ post without author
          âœ“ page
        primary tag permalink
          âœ“ serve post (54ms)
          âœ“ post without tag
          âœ“ post without tag
          âœ“ page
        collection/routes with data key
          âœ“ serve /food/ (42ms)
          âœ“ serve bacon tag
          âœ“ serve /sport/ (46ms)
          âœ“ serve chorizo tag (38ms)
          âœ“ serve my-page
      extended routes.yaml: templates
        default template, no template
          âœ“ serve collection
          âœ“ serve second collectiom
        two templates
          âœ“ serve collection
        home.hbs priority
          âœ“ serve collection
          âœ“ serve second page collection: should use index.hbs
      extended routes.yaml: routes
        channels
(node:6021) MaxListenersExceededWarning: Possible EventEmitter memory leak detected. 101 server.start listeners added to [EventRegistry]. Use emitter.setMaxListeners() to increase limit
          âœ“ serve channel 1
          âœ“ serve channel 1: rss
          âœ“ serve channel 2
          âœ“ serve channel 3
          âœ“ serve channel 4
          âœ“ serve channel 5
          âœ“ serve channel 6
          âœ“ serve kitching-sink: redirect
          âœ“ serve html-ipsum: redirect
          âœ“ serve chorizo: no redirect
          âœ“ serve joe-bloggs
      extended routes.yaml (5): rss override
        âœ“ serve /rss/
        âœ“ serve /music/rss/
        âœ“ serve /cooking/rss/
        âœ“ serve /flat/rss/
        âœ“ serve /podcast/rss/
        âœ“ serve /podcast/
    canary
      default routes.yaml
        behaviour: default cases
          âœ“ serve post (70ms)
          âœ“ serve amp
          âœ“ post not found
          âœ“ serve static page
          âœ“ serve author (46ms)
          âœ“ serve tag (54ms)
          âœ“ serve tag rss
          âœ“ serve collection (41ms)
          âœ“ serve collection: page 2
          âœ“ serve theme asset
        behaviour: prettify
          âœ“ url without slash
        behaviour: url redirects
          pagination
            âœ“ redirect /page/1/ to /
          rss
            âœ“ redirect /feed/ to /rss/
      https
        protocol
          âœ“ blog is https, request is http
          âœ“ blog is https, request is http, trailing slash exists already
        assets
          âœ“ blog is https, request is http
          âœ“ blog is https, request is http
      extended routes.yaml: collections
        2 collections
          âœ“ serve static route
          âœ“ serve rss
          âœ“ serve post
          âœ“ serve collection: podcast with default template
          âœ“ serve collection: something with custom template
        no collections
          âœ“ serve route
        static permalink route
          âœ“ serve post
          âœ“ serve post (54ms)
          âœ“ serve author
          âœ“ serve tag
        primary author permalink
          âœ“ serve post (57ms)
          âœ“ post without author
          âœ“ page
        primary tag permalink
          âœ“ serve post (51ms)
          âœ“ post without tag
          âœ“ post without tag
          âœ“ page
        collection/routes with data key
          âœ“ serve /food/
          âœ“ serve bacon tag
          âœ“ serve /sport/
          âœ“ serve chorizo tag
          âœ“ serve my-page
      extended routes.yaml: templates
        default template, no template
          âœ“ serve collection
          âœ“ serve second collectiom
        two templates
          âœ“ serve collection
        home.hbs priority
          âœ“ serve collection
          âœ“ serve second page collection: should use index.hbs
      extended routes.yaml: routes
        channels
          âœ“ serve channel 1
          âœ“ serve channel 1: rss
          âœ“ serve channel 2
          âœ“ serve channel 3
          âœ“ serve channel 4
          âœ“ serve channel 5
          âœ“ serve channel 6 (44ms)
          âœ“ serve kitching-sink: redirect
          âœ“ serve html-ipsum: redirect
          âœ“ serve chorizo: no redirect
          âœ“ serve joe-bloggs
      extended routes.yaml (5): rss override
        âœ“ serve /rss/
        âœ“ serve /music/rss/
        âœ“ serve /cooking/rss/
        âœ“ serve /flat/rss/
        âœ“ serve /podcast/rss/
        âœ“ serve /podcast/
    v3
      default routes.yaml
        behaviour: default cases
          âœ“ serve post (57ms)
          âœ“ serve amp
          âœ“ post not found
          âœ“ serve static page
          âœ“ serve author (41ms)
          âœ“ serve tag
          âœ“ serve tag rss
          âœ“ serve collection
          âœ“ serve collection: page 2
          âœ“ serve theme asset
        behaviour: prettify
          âœ“ url without slash
        behaviour: url redirects
          pagination
            âœ“ redirect /page/1/ to /
          rss
            âœ“ redirect /feed/ to /rss/
      https
        protocol
          âœ“ blog is https, request is http
          âœ“ blog is https, request is http, trailing slash exists already
        assets
          âœ“ blog is https, request is http
          âœ“ blog is https, request is http
      extended routes.yaml: collections
        2 collections
          âœ“ serve static route
          âœ“ serve rss
          âœ“ serve post
          âœ“ serve collection: podcast
          âœ“ serve collection: something with custom template
        no collections
          âœ“ serve route
        static permalink route
          âœ“ serve post
          âœ“ serve post (52ms)
          âœ“ serve author
          âœ“ serve tag
        primary author permalink
          âœ“ serve post (53ms)
          âœ“ post without author
          âœ“ page
        primary tag permalink
          âœ“ serve post (57ms)
          âœ“ post without tag
          âœ“ post without tag
          âœ“ page
        collection/routes with data key
          âœ“ serve /food/ (40ms)
          âœ“ serve bacon tag
          âœ“ serve /sport/
          âœ“ serve chorizo tag
          âœ“ serve my-page
      extended routes.yaml: templates
        default template, no template
          âœ“ serve collection
          âœ“ serve second collectiom
        two templates
          âœ“ serve collection
        home.hbs priority
          âœ“ serve collection
          âœ“ serve second page collection: should use index.hbs
      extended routes.yaml: routes
        channels
          âœ“ serve channel 1
          âœ“ serve channel 1: rss
          âœ“ serve channel 2
          âœ“ serve channel 3
          âœ“ serve channel 4
          âœ“ serve channel 5
          âœ“ serve channel 6
          âœ“ serve kitching-sink: redirect
          âœ“ serve html-ipsum: redirect
          âœ“ serve chorizo: no redirect
          âœ“ serve joe-bloggs
      extended routes.yaml (5): rss override
        âœ“ serve /rss/
        âœ“ serve /music/rss/
        âœ“ serve /cooking/rss/
        âœ“ serve /flat/rss/
        âœ“ serve /podcast/rss/
        âœ“ serve /podcast/
    parent app vhosts
      no separate admin
        âœ“ loads the front-end on configured url
        âœ“ loads the front-end on localhost
        âœ“ loads the admin
        âœ“ loads the admin on localhost
        âœ“ loads the api
        âœ“ loads the api on localhost
      separate admin host
        âœ“ loads the front-end on configured url (38ms)
        âœ“ loads the front-end on localhost (38ms)
        âœ“ redirects /ghost/ on configured url
        âœ“ 404s the api on configured url
        âœ“ 404s the api on localhost
        âœ“ loads the admin on configured admin url
        âœ“ loads the api on configured admin url
        âœ“ redirects to the correct protocol on configured admin url
        âœ“ 404s the front-end on configured admin url
      separate admin host w/ admin redirects disabled
        âœ“ does not redirect /ghost/ on configured url
      same host separate protocol
        âœ“ loads the front-end on configured url (http)
        âœ“ 404s the front-end on configured url (https) (38ms)
        âœ“ loads the front-end on localhost
        âœ“ redirects /ghost/ on configured url
        âœ“ redirects /ghost/ on localhost
        âœ“ redirects api to correct protocol on configured admin url
        âœ“ loads the admin on configured admin url
        âœ“ redirects the admin on localhost
        âœ“ loads the api on configured admin url
        âœ“ redirects the api on localhost

  Integration: services/url/UrlService
    functional: default routing set
      âœ“ check url generators
      âœ“ getUrl
      âœ“ getResource
    functional: extended/modified routing set
      âœ“ check url generators
      âœ“ getUrl
    functional: subdirectory
      âœ“ check url generators
      âœ“ getUrl

  Update Check
    fn: updateCheck
      âœ“ update check was never executed
      âœ“ update check won't happen if it's too early
      âœ“ update check will happen if it's time to check
    fn: updateCheckData
      âœ“ should report the correct data (174ms)
    fn: createCustomNotification
      âœ“ should create a release notification for target version
      âœ“ release notification version format is wrong
      âœ“ blog version format is wrong
      âœ“ should create a custom notification
      âœ“ should not add duplicates
    fn: updateCheckResponse
      âœ“ receives a notifications with messages
      âœ“ receives multiple notifications
      âœ“ ignores some custom notifications which are not marked as group
      âœ“ group matches
      âœ“ single custom notification received, group matches
      âœ“ single custom notification received, group does not match
    fn: updateCheckRequest
      âœ“ [default]
      âœ“ privacy flag is used
      âœ“ received 500 from the service
      âœ“ received 404 from the service
      âœ“ custom url


  774 passing (8m)
  35 pending
  1 failing

  1) Slack API
       "before all" hook:
     NotFoundError: Integration not found.
    at new NotFoundError (node_modules/ghost-ignition/lib/errors/index.js:106:23)
    at Child.<anonymous> (core/server/adapters/scheduling/post-scheduling/index.js:20:23)
    at Child.tryCatcher (node_modules/bookshelf/node_modules/bluebird/js/release/util.js:16:23)
    at Promise._settlePromiseFromHandler (node_modules/bookshelf/node_modules/bluebird/js/release/promise.js:547:31)
    at Promise._settlePromise (node_modules/bookshelf/node_modules/bluebird/js/release/promise.js:604:18)
    at Promise._settlePromise0 (node_modules/bookshelf/node_modules/bluebird/js/release/promise.js:649:10)
    at Promise._settlePromises (node_modules/bookshelf/node_modules/bluebird/js/release/promise.js:729:18)
    at _drainQueueStep (node_modules/bookshelf/node_modules/bluebird/js/release/async.js:93:12)
    at _drainQueue (node_modules/bookshelf/node_modules/bluebird/js/release/async.js:86:9)
    at Async._drainQueues (node_modules/bookshelf/node_modules/bluebird/js/release/async.js:102:5)
    at Immediate.Async.drainQueues [as _onImmediate] (node_modules/bookshelf/node_modules/bluebird/js/release/async.js:15:14)
    at processImmediate (internal/timers.js:439:21)
    at process.topLevelDomainCallback (domain.js:130:23)
  



Warning:  Use --force to continue.

Aborted due to warnings.
error Command failed with exit code 3.
info Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command.
travis_time:end:003b23c8:start=1580331030895015617,finish=1580331511101083772,duration=480206068155,event=script
[0K[31;1mThe command "if [[ "$TRAVIS_PULL_REQUEST_BRANCH" =~ ^renovate || "$TRAVIS_EVENT_TYPE" == "cron" ]]; then
  yarn ci:regression
else
  yarn ci
fi
" exited with 3.[0m
travis_fold:start:cache.2
[0Kstore build cache
travis_time:start:09a0817a
[0Ktravis_time:end:09a0817a:start=1580331511108208752,finish=1580331511110790466,duration=2581714,event=cache
[0Ktravis_time:start:08d006a2
[0K[32;1mnothing changed[0m
travis_time:end:08d006a2:start=1580331511114267513,finish=1580331516162674731,duration=5048407218,event=cache
[0Ktravis_fold:end:cache.2
[0K

Done. Your build exited with 1.