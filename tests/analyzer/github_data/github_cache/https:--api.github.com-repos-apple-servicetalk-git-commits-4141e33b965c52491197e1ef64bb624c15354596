{"sha":"4141e33b965c52491197e1ef64bb624c15354596","node_id":"C_kwDOCM50e9oAKDQxNDFlMzNiOTY1YzUyNDkxMTk3ZTFlZjY0YmI2MjRjMTUzNTQ1OTY","url":"https://api.github.com/repos/apple/servicetalk/git/commits/4141e33b965c52491197e1ef64bb624c15354596","html_url":"https://github.com/apple/servicetalk/commit/4141e33b965c52491197e1ef64bb624c15354596","author":{"name":"Idel Pivnitskiy","email":"idel.pivnitskiy@apple.com","date":"2022-04-13T09:52:43Z"},"committer":{"name":"GitHub","email":"noreply@github.com","date":"2022-04-13T09:52:43Z"},"tree":{"sha":"5054211c11e255fb3696b1fb184a61687b51d733","url":"https://api.github.com/repos/apple/servicetalk/git/trees/5054211c11e255fb3696b1fb184a61687b51d733"},"message":"`LoadBalancer` and `ConnectionFactory`: add a context of the caller (#2168)\n\nMotivation:\r\n\r\n`LoadBalancer` and `ConnectionFactory` API is disconnected from  the\r\ncaller, lacks context who/why selects/creates a connection, and has no\r\nAPI to propagate additional information from the caller (request).\r\n\r\nModifications:\r\n\r\n- `LoadBalancer`: add new `selectConnection(Predicate, ContextMap)`\r\nmethod, deprecate `selectConnection(Predicate)`;\r\n- `ConnectionFactory`: add new\r\n`newConnection(Address, ContextMap, TransportObserver)` method,\r\ndeprecate `newConnection(Address, TransportObserver)`;\r\n- Migrate all LB/CF implementations and tests to use new API;\r\n- Add `DeprecatedToNewConnectionFactoryFilter` after each user-defined\r\nCF to make sure old/new filters work in the same pipeline;\r\n\r\nResult:\r\n\r\nInformation can be propagated from the caller to the\r\n`LoadBalancer` and `ConnectionFactory`.","parents":[{"sha":"ac4dddb9361cc2e2045fc9f6feb1a67dbeebf997","url":"https://api.github.com/repos/apple/servicetalk/git/commits/ac4dddb9361cc2e2045fc9f6feb1a67dbeebf997","html_url":"https://github.com/apple/servicetalk/commit/ac4dddb9361cc2e2045fc9f6feb1a67dbeebf997"}],"verification":{"verified":true,"reason":"valid","signature":"-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJiVp1rCRBK7hj4Ov3rIwAATu8IAE6/JRMow+BNW4MNEVkzZFzZ\nGjJBzdDflhT6mFC8loczBmg9jF9BCxUlDmOQHqCvqKdBbwJFG+RbsYBpjvJEX6Gn\nPK+r/3Tn/W4aRRzASSPDFGfJ/vg3yYezMKCknAOz2sQrsZyXBA5JfWO/UioS4yp5\ne2njaK1sHXWtY0OiE7o/mColEat94v1+6DSIYhsJrFrh1oEclRS0wlcq2nXZm3z4\nfw061Ps/rYxm0h2wfH54TfGSOtoC0XWw3MpSWSrksRrq3+pnhGXJwR5RuI8BzT8l\nUxc0qHeWd/cyxriU6GmUAQIAdxJmC+GfYa2AO7jxkCVGCEj8Dvr+Lgjlfxv+A+c=\n=xLXP\n-----END PGP SIGNATURE-----\n","payload":"tree 5054211c11e255fb3696b1fb184a61687b51d733\nparent ac4dddb9361cc2e2045fc9f6feb1a67dbeebf997\nauthor Idel Pivnitskiy <idel.pivnitskiy@apple.com> 1649843563 -0500\ncommitter GitHub <noreply@github.com> 1649843563 +0200\n\n`LoadBalancer` and `ConnectionFactory`: add a context of the caller (#2168)\n\nMotivation:\r\n\r\n`LoadBalancer` and `ConnectionFactory` API is disconnected from  the\r\ncaller, lacks context who/why selects/creates a connection, and has no\r\nAPI to propagate additional information from the caller (request).\r\n\r\nModifications:\r\n\r\n- `LoadBalancer`: add new `selectConnection(Predicate, ContextMap)`\r\nmethod, deprecate `selectConnection(Predicate)`;\r\n- `ConnectionFactory`: add new\r\n`newConnection(Address, ContextMap, TransportObserver)` method,\r\ndeprecate `newConnection(Address, TransportObserver)`;\r\n- Migrate all LB/CF implementations and tests to use new API;\r\n- Add `DeprecatedToNewConnectionFactoryFilter` after each user-defined\r\nCF to make sure old/new filters work in the same pipeline;\r\n\r\nResult:\r\n\r\nInformation can be propagated from the caller to the\r\n`LoadBalancer` and `ConnectionFactory`."}}
